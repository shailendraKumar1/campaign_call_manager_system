{
  "info": {
    "name": "Campaign Call Manager API - Updated",
    "description": "Complete API collection for Campaign Call Manager System\n\n‚ú® Features:\n- Celery + Redis async task processing\n- Queue-based callback architecture\n- Connection pooling (PostgreSQL & Redis)\n- Bulk call operations (1000+ concurrent calls)\n- Multi-layer retry logic\n- Dead Letter Queue (DLQ) for error recovery\n- Comprehensive testing suite\n\nüöÄ Quick Start:\n1. Start services: python manage.py start_all\n2. Set authToken variable to your token\n3. Run 'Complete Workflow' folder\n\nüìö Test Suite: python test_comprehensive_suite.py",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_postman_id": "campaign-call-manager-v4-updated"
  },
  "auth": {
    "type": "apikey",
    "apikey": [
      {
        "key": "value",
        "value": "{{authToken}}",
        "type": "string"
      },
      {
        "key": "key",
        "value": "X-Auth-Token",
        "type": "string"
      }
    ]
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8000",
      "type": "string"
    },
    {
      "key": "authToken",
      "value": "dev-token-12345",
      "type": "string"
    },
    {
      "key": "campaignId",
      "value": "1",
      "type": "string"
    },
    {
      "key": "callId",
      "value": "",
      "type": "string"
    },
    {
      "key": "phoneNumber",
      "value": "+1234567890",
      "type": "string"
    },
    {
      "key": "mockServiceUrl",
      "value": "http://localhost:8001",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "üè• System Health & Prerequisites",
      "item": [
        {
          "name": "System Metrics",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/metrics/",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "metrics", ""]
            }
          },
          "response": []
        },
        {
          "name": "Mock Service Health",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{mockServiceUrl}}/health",
              "host": ["{{mockServiceUrl}}"],
              "path": ["health"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "üìã Campaign Management",
      "item": [
        {
          "name": "Create Campaign",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    pm.collectionVariables.set('campaignId', response.id);",
                  "    console.log('Campaign ID set to:', response.id);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Test Campaign {{$timestamp}}\",\n    \"description\": \"Postman test campaign for API validation\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/campaigns/",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "campaigns", ""]
            }
          },
          "response": []
        },
        {
          "name": "List Campaigns",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/campaigns/",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "campaigns", ""]
            }
          },
          "response": []
        },
        {
          "name": "Get Campaign Details",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/campaigns/{{campaignId}}/",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "campaigns", "{{campaignId}}", ""]
            }
          },
          "response": []
        },
        {
          "name": "Add Phone Numbers",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"campaign_id\": {{campaignId}},\n    \"phone_numbers\": [\n        \"+1555000001\",\n        \"+1555000002\",\n        \"+1555000003\",\n        \"+1555000004\",\n        \"+1555000005\"\n    ]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/phone-numbers/",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "phone-numbers", ""]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "üìû Call Initiation",
      "item": [
        {
          "name": "Single Call Initiation",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    pm.collectionVariables.set('callId', response.call_id);",
                  "    console.log('Call ID set to:', response.call_id);",
                  "} else if (pm.response.code === 429) {",
                  "    console.log('System at capacity - this is expected behavior');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"phone_number\": \"{{phoneNumber}}\",\n    \"campaign_id\": {{campaignId}}\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/initiate-call/",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "initiate-call", ""]
            }
          },
          "response": []
        },
        {
          "name": "Bulk Call Initiation (Small)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"campaign_id\": {{campaignId}},\n    \"phone_numbers\": [\n        \"+1888000001\",\n        \"+1888000002\",\n        \"+1888000003\",\n        \"+1888000004\",\n        \"+1888000005\",\n        \"+1888000006\",\n        \"+1888000007\",\n        \"+1888000008\",\n        \"+1888000009\",\n        \"+1888000010\"\n    ]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/bulk-initiate-calls/",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "bulk-initiate-calls", ""]
            }
          },
          "response": []
        },
        {
          "name": "Bulk Call Initiation (Use Campaign Numbers)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"campaign_id\": {{campaignId}},\n    \"use_campaign_numbers\": true\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/bulk-initiate-calls/",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "bulk-initiate-calls", ""]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "üîÑ Callback Processing",
      "item": [
        {
          "name": "Callback - PICKED",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"call_id\": \"{{callId}}\",\n    \"status\": \"PICKED\",\n    \"call_duration\": 45,\n    \"external_call_id\": \"ext_{{$randomAlphaNumeric}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/callback/",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "callback", ""]
            }
          },
          "response": []
        },
        {
          "name": "Callback - DISCONNECTED",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"call_id\": \"{{callId}}\",\n    \"status\": \"DISCONNECTED\",\n    \"external_call_id\": \"ext_{{$randomAlphaNumeric}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/callback/",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "callback", ""]
            }
          },
          "response": []
        },
        {
          "name": "Callback - RNR",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"call_id\": \"{{callId}}\",\n    \"status\": \"RNR\",\n    \"external_call_id\": \"ext_{{$randomAlphaNumeric}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/callback/",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "callback", ""]
            }
          },
          "response": []
        },
        {
          "name": "Callback - FAILED",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"call_id\": \"{{callId}}\",\n    \"status\": \"FAILED\",\n    \"external_call_id\": \"ext_{{$randomAlphaNumeric}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/callback/",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "callback", ""]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "üß™ Error Handling Tests",
      "item": [
        {
          "name": "Invalid Authentication",
          "request": {
            "auth": {
              "type": "apikey",
              "apikey": [
                {
                  "key": "value",
                  "value": "invalid-token",
                  "type": "string"
                },
                {
                  "key": "key",
                  "value": "X-Auth-Token",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/metrics/",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "metrics", ""]
            }
          },
          "response": []
        },
        {
          "name": "Invalid Campaign ID",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"phone_number\": \"+1234567890\",\n    \"campaign_id\": 99999\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/initiate-call/",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "initiate-call", ""]
            }
          },
          "response": []
        },
        {
          "name": "Invalid Callback Status",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"call_id\": \"test-call-id\",\n    \"status\": \"INVALID_STATUS\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/callback/",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "callback", ""]
            }
          },
          "response": []
        },
        {
          "name": "Missing Required Fields",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"phone_number\": \"+1234567890\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/initiate-call/",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "initiate-call", ""]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "üöÄ Complete Workflow Test",
      "item": [
        {
          "name": "1. Create Test Campaign",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Campaign created successfully', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    pm.collectionVariables.set('campaignId', response.id);",
                  "    console.log('‚úÖ Campaign created with ID:', response.id);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Workflow Test Campaign {{$timestamp}}\",\n    \"description\": \"Complete workflow test campaign\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/campaigns/",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "campaigns", ""]
            }
          },
          "response": []
        },
        {
          "name": "2. Add Phone Numbers",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Phone numbers added successfully', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    console.log('‚úÖ Added', response.created_count, 'phone numbers');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"campaign_id\": {{campaignId}},\n    \"phone_numbers\": [\n        \"+1777000001\",\n        \"+1777000002\",\n        \"+1777000003\",\n        \"+1777000004\",\n        \"+1777000005\"\n    ]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/phone-numbers/",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "phone-numbers", ""]
            }
          },
          "response": []
        },
        {
          "name": "3. Initiate Single Call",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Call initiated or capacity limit reached', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([201, 429]);",
                  "});",
                  "",
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    pm.collectionVariables.set('callId', response.call_id);",
                  "    console.log('‚úÖ Call initiated with ID:', response.call_id);",
                  "} else if (pm.response.code === 429) {",
                  "    console.log('‚ö†Ô∏è System at capacity - this is expected behavior');",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"phone_number\": \"+1777000001\",\n    \"campaign_id\": {{campaignId}}\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/initiate-call/",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "initiate-call", ""]
            }
          },
          "response": []
        },
        {
          "name": "4. Check System Metrics",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Metrics retrieved successfully', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    const metrics = pm.response.json();",
                  "    console.log('üìä Current concurrent calls:', metrics.current_concurrent_calls);",
                  "    console.log('üìä System status:', metrics.system_status);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/metrics/",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "metrics", ""]
            }
          },
          "response": []
        },
        {
          "name": "5. Bulk Call Initiation",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Bulk calls initiated successfully', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    console.log('‚úÖ Bulk calls - Immediate:', response.immediate_processed);",
                  "    console.log('‚úÖ Bulk calls - Queued:', response.queued_for_later);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"campaign_id\": {{campaignId}},\n    \"use_campaign_numbers\": true\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/bulk-initiate-calls/",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "bulk-initiate-calls", ""]
            }
          },
          "response": []
        }
      ]
    }
  ]
}
